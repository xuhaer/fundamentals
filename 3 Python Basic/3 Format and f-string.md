## 字符串格式化(format) 

### 使用关键字参数:

```python
hash = {'name':'hoho','age':18}
'my name is {name},age is {age}'.format(**hash)
```

###  填充与格式化:

`{:[填充字符][对齐方式 <^>][宽度]}`

注意: `:`后不能加空格, `:`q 前的`0`可省略

```python
>>> '{:*>10}'.format(10)   # 或 '{0:*>10}'.format(10) 
'********10'
>>> '{0:*^10}'.format(10)  # 居中对齐
'****10****'
```

### 精度与进制

```python
>>> '{:.2f}'.format(1/3)
'0.33'
>>> '{:b}'.format(3)    # 将十进制的 3 转为二进制字符串
'11'
>>> '{:o}'.format(9)    # 八进制
'11'
>>> '{:x}'.format(10)   # 十六进制
'a'
>>> '{:,}'.format(12369132698)  # 千分位格式化
'12,369,132,698'
```

另外，上面用`format`做进制转换与 `bin函数`等的区别:

```python
>>> bin(3)
'0b11'
>>> oct(9)
'0o11'
>>> hex(10)
'0xa'
```

如果要将其它进制的(数字)字符串转换为十进制的数字呢? 使用`int(value, base)`函数

```python
>>> int('{:b}'.format(3), 2) # 等价于int('11', 2)
3
>>> int(bin(3), 2)			 # 等价于int('0b11', 2)
3
```

这样的话可通过 int 函数和 format方法 或(bin、oct、hex函数) 做 二、八、十、十六进制间的转换:

```python
# 将2进制(数字)字符串转为16进制字符串
# 通过int 将二进制(数字)字符串先转为十进制数字, 再转为16进制字符串(hex string)
>>> hex(int('0b11', 2)) # 或 hex(int('11', 2))
'0x3'
>>> '{:x}'.format(int('11',2))
'3'
```

## f-string

f-string在本质上并不是字符串常量，而是一个在运行时运算求值的表达式



### 引号、花括号和反斜杠

f-string大括号内所用的引号不能和大括号外的引号定界符冲突，可根据情况灵活切换 `'` 和 `"`, 若 `'` 和 `"` 不足以满足要求，还可以使用 `'''` 和 `"""`：：

```python
>>> f'I am {"Eric"}'
'I am Eric'
```

花括号外的引号还可以使用 \ 转义，但**花括号内不能出现 `\` , 如果确实需要 `\`，则应首先将包含 `\` 的内容用一个变量表示，再在f-string大括号内填入变量名：**

```python
>>> f'I\'m {2019 - 1995}'
"I'm 24"
>>> f"{ord('\n')}"
  File "<stdin>", line 1
SyntaxError: f-string expression part cannot include a backslash
>>> a = ord('\n')
>>> f"{a}"
'10'
```

f-string大括号外如果需要显示大括号，则应输入连续两个大括号 `{{` 和 `}}`：

```python
>>> f"{{'dict-string':1}}"
"{'dict-string':1}"
```



### 填充、精度与进制

f-string采用 `{content:format}` 设置字符串格式，其中 `content` 是替换并填入字符串的内容，可以是变量、表达式或函数等，`format`是格式描述符。采用默认格式时不必指定 `{:format}`，如上面例子所示只写 `{content}` 即可。

#### 对齐相关格式描述符

```python
>>> f'{1 + 2:*>10}'
'*********3'
>>> f'{1 + 2:^4}'
' 3  '
```
2019-06-14补充：字符串的填充与对齐也可直接调用 str.ljust、str.rjust、str.center 方法，比 f-string 快一点。
```Python
text = '10'
# 速度依次为: 227 ns, 247 ns
text.ljust(10, '*') == f'{text:*<10}' == '10********' # True

# 但是，f-string 更通用，适用于格式化任意对象，而不仅仅是字符串。比如后面的关于数字部分。
# 优先考虑 f-string：
a, b = 'Is Chicago', 'Not Chicago?'
# 速度: 14.9 ns, 183 ns, 422 ns 差距非常大！
f'{a} {b}' == a + ' ' + b == '{} {}'.format(a, b)'
```

当我们使用加号 (+) 操作符去连接大量的字符串的时候是非常低效率的，因为加号连接会引起内存复制以及垃圾回收操作。特别的，你永远都不应像下面这样写字符串连接代码(应用 `''.join`):
```Python
s = ''
for p in parts:
  s += p
```

#### 数字符号相关格式描述符(仅适用于数值类型)

* `+`: 负数前加负号（-），正数前加正号（+）
* `-` :负数前加负号（`-`），正数前不加任何符号（默认）
* ` `(空格): 负数前加负号（`-`），正数前加一个空格

```python
>>> f'{1 + 2:+}' 
'+3'
>>> f'{1 + 2: }'
' 3'
```

#### **数字显示方式**相关格式描述符`#`:切换数字显示方式(仅适用于数值类型)

`#` 对不同数值类型的作用效果不同:

|  数值类型  | 不加`#`（默认） |    加`#`    |     区别      |
| :--------: | :-------------: | :---------: | :-----------: |
| 二进制整数 |    '1111011'    | '0b1111011' | 开头有无 `0b` |
| 八进制整数 |      '173'      |   '0o173'   | 开头有无 `0o` |
| 十进制整数 |      '123'      |    '123'    |    无区别     |
| 十六(小写) |      '7b'       |   '0x7b'    | 开头有无 `0x` |
| 十六(大写) |      '7B'       |   '0X7B'    | 开头有无 `0X` |

```python
>>> f'{1 - 3: #b}'
'-0b10'
```

#### **宽度与精度**相关格式描述符

* `width`: 整数 `width` 指定宽度
* `0width`:整数 `width` 指定宽度，开头的 `0` 指定高位用 `0` 补足宽度
* `width.precision`:整数 `width` 指定宽度，整数 `precision` 指定显示精度

注1: `0width` 不可用于复数类型和非数值类型，`width.precision` 不可用于整数类型。 

注2:`width.precision` 用于不同格式类型的浮点数、复数时的含义也不同：用于 `f`、`F`、`e`、`E` 和 `%` 时 `precision` 指定的是小数点后的位数，用于 `g` 和 `G` 时 `precision` 指定的是有效数字位数（小数点前位数+小数点后位数）。

注3:`width.precision` 除浮点数、复数外还可用于字符串，此时 `precision` 含义是只使用字符串中前 `precision` 位字符。

```python
>>> f'{123.456:8.2f}'
'  123.46'
>>> f'{123.456:8.2%}'
'12345.60%'
>>> f"{'hello':8.2}"
'he      '
```

#### 千分位

`,` 仅适用于浮点数、复数与十进制整数：对于浮点数和复数，`,` 只分隔小数点前的数位。

`_` 适用于浮点数、复数与二、八、十、十六进制整数：对于浮点数和复数，`_` 只分隔小数点前的数位；对于二、八、十六进制整数，固定从低位到高位每隔四位插入一个 `_`（十进制整数是每隔三位插入一个 `_`）。

```python
>>> f'{12345:,}'
'12,345'
>>> f'{32:_b}'
'10_0000'
```

另外，f-string还可用于 date、datetime 和 time 对象

```python
>>> f'{time:%Y-%m-%d(%a) %H:%M:%S}'
'2019-01-18(Fri) 13:56:21'
```

